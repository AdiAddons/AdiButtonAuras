sudo: false
env:
  global:
  - LUA=lua5.1
  - LUAC=luac5.1
addons:
  apt:
    packages:
    - lua5.1
    - luarocks
    - liblua5.1-bitop0
install:
- eval $(luarocks path --bin)
- luarocks install --local luaunit 2.1
- luarocks install --local mockagne 1.0
- luarocks install --local luacheck
before_script:
- '$HOME/.luarocks/bin/luacheck . --config .luacheckrc --exclude-files "./tests/*" -qo "011" "111" "112" "113"'
script:
- cd tests
- "./cs.sh"
- "$LUA Items.lua"
notifications:
  email:
    on_failure: change
    on_success: change
  webhooks:
    urls:
    - https://webhooks.gitter.im/e/8af376a7b5a9d8919d21
    on_success: change
    on_failure: always
deploy:
  provider: script
  script: "curl -sdS https://www.wowace.com/api/projects/68441/package?token=$WOWACE_API_TOKEN"
  on:
    repo: AdiAddons/AdiButtonAuras
    all_branches: true
    condition: "$TRAVIS_BRANCH = master || -n $TRAVIS_TAG"
cache:
  apt: true
  directories:
  - "$HOME/.luarocks"
